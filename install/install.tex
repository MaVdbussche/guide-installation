\documentclass{../guide}

\newcounter{stepcounter}

\newcommand{\newstep}[1]{\stepcounter{stepcounter}\section{Step \thestepcounter : #1}}

\title{Le guide de l'installeur galactique}
\author{Benoît Legat}

\begin{document}

\maketitle

\section{Prise d'informations}
\subsection{L'architecture}
\begin{itemize}
  \item ARM ou x86 ? Sûrement x86.
  \item 64-bits ou 32-bit ? 64-bit s'il est récent mais autant s'en assurer.
\end{itemize}

Comment savoir
\subsubsection{Sur Windows}
\paragraph{Windows XP}
\todo[inline] Clique-droit sur ``My computer'' -> ``Properties''. Dans la catégorie ``System'', si il est écrit ``x64 edition'', c'est la version 64 bit, si vous ne voyez pas ``64'' quelque part, ça veut dire que c'est du 32bits.
\paragraph{Windows Vista/7}
\todo[inline] Même chose que Windows XP, mais il sera explicitement écrit ``32-bit operating system'' ou ``64-bit operating system''.
\paragraph{Windows 8.1}
\todo[inline]{TODO}
\paragraph{Windows 10}
\todo[inline]{TODO}
\subsubsection{Sous MAC}
\todo[inline] Ils sont tous 64 bits depuis 2008… Si vous voyez un tout veil ordi, regardez le type de processeur (Cliquer sur la pomme en haut à gauche -> ``About this mac'', si le processeur est un ``Intel Core Solo'' ou ``Intel Core Duo'', c'est du 32-bit.
\subsubsection{Sur Linux}
Comment le savoir ? \verb|i386| veut dire 32-bit et \verb|x86_64| veut dire 64-bit.
\begin{minted}{bash}
$ uname -a
\end{minted}

\subsection{Méthode de partitionnement}
GPT ou MBR.

Comment savoir \todo{TODO}
As a rule of thumb, si c'est Windows 8 ou plus c'est GPT.

\subsection{Repartitionnement}
Quels est la taille de la partition et les partitions présentes ?
\subsubsection{Sous Windows}
Aller dans le ``Gestionnaire de Disques''.
\paragraph{Windows 7 ou moins}
Clique droit sur ``My computer'' -> ``Manage''.
\paragraph{Windows 8 ou plus}
Clique droit sur menu démarrer -> ``Gestionnaire de disque''.
\subsubsection{Sous MAC}
\todo[inline]{TODO}
\subsubsection{Sous Linux}
GParted ou plus rapide:
\begin{minted}{bash}
$ lsblk
\end{minted}

\section{Choix à faire avec le client}

\subsection{Quelle distribution ?}
%Demander au client de choisir dans le menu.
Si ils demandent, ce qu'ils veulent (tant qu'on a l'ISO…), mais par défaut, Ubuntu. Pas besoin de leur faire peur inutilement !

\subsection{Quel place est-ce que le client veut donner ?}
Pour Linux, la taille de \verb|/|: minimum \SI{20}{GB} mais c'est short, \SI{32}{GB} c'est mieux, \SI{42}{GB} pour être tranquille.

Faire une SWAP entre \SI{2}{GB} et \SI{4}{\giga B}.

\subsection{Faire une partition home séparée ou pas ?}
Il y a deux cas de figures possibles:
\begin{enumerate}
  \item SWAP et \verb|/|
  \item SWAP, \verb|/home| et \verb|/|
\end{enumerate}

L'avantage de la deuxième c'est que si l'OS crash ou si il le client veut installer une autre distro ou une fresh install au lieu d'une update, en faisant l'install en demandant de ne pas reformatter la partition \verb|/home|, il n'y a que l'OS et les applications qui sont overwritten et les données restes inchangées.

Le désavantage de la deuxième c'est qu'il faut choisir la taille du \verb|/home| et \verb|/| maintenant et s'y tenir.
Seulement, la taille de \verb|/| n'est pas vraiment variable, on met souvent \SI{42}{GB} à \verb|/| et le reste à \verb|/home|.

\newstep{Défragmenter}
Idéalement ça doit déjà avoir été fait normalement...
C'est optionnel mais ça permet de plus diminuer la taille de Windows en Step 3.

\newstep{Désactiver le Fast Boot}
Ne pas confondre avec la désactivation du Fast Boot depuis le BIOS !

Choisir les options d'alimentation/Power Option...

\newstep{Diminuer la taille de Windows}
En MBR, s'il y a déjà 4 partitions il va falloir en supprimer une..
Il faut redimensionner Windows \emph{depuis Windows}.
C'est normal qu'il prenne du temps à calculer l'espace qu'il autorise à réduire et c'est normal que ce soit moins que l'espace libre.

\newstep{Rebooter dans l'UEFI}
Appuyer sur control-alt-shift quand vous cliquez sur le bouton ``Redémarrer''.

\newstep{Chipoter dans l'UEFI}
\begin{itemize}
  \item Disable Secure Boot.
  \item Disable Fast Boot.
  \item Enable CSM. (C'est pour que l'UEFI apparaisse comme un BIOS)
\end{itemize}
Mettre l'USB en priorité dans l'ordre de Boot.
Si l'USB n'est pas proposé, essayer de rebooter après avoir désactivé le Secure Boot.

Il se peut qu'il faille créer la Boot Entry soi-même (e.g. ASUS),
pour cela, il faut le faire pointer vers \verb|/boot/BOOTx86_64.efi|.

\newstep{Rebooter}
Maintenant, on reboot et ça devrait booter sur la clef (si ça ne marche pas, vous être autorisé à pleurer).

Choisir ``Try ...'' au lieu de ``Installer directemen't' pour avoir GParted.

\newstep{Créer les partitions}
Créer les partitions comme choisi au préalable avec le client.

\newstep{Se connecter}
Wifi c'est bien, Ethernet, c'est mieux !
Brancher aussi le PC, si ce n'est pas encore fait.

\newstep{Lancer l'installation}
Double cliquer sur les partitions ext4 créées pour qu'elles soient utilisées.
Ne pas reformater la partition \verb|/home| s'il y a des données (e.g. reinstall).

\newstep{Rebooter}
Checkez si Windows marche.
Checkez si Linux marche:
\begin{itemize}
  \item Wifi
  \item Son
  \item Luminosité
  \item ...
\end{itemize}
Démarrez ``Additionnal drivers'' pour installer des drivers supplémentaires (e.g. wifi, carte graphique).

\subsection{Drivers graphiques}
\todo[inline]{Copier coller du drive}

\end{document}
